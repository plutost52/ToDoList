<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.todolist.member.dao.MemberDao">

    <select id="findById" resultType="com.example.todolist.member.dto.MemberDto">
        SELECT MEMBER_NO
             ,MEMBER_EMAIL
             ,MEMBER_PWD
             ,MEMBER_NAME
             ,MEMBER_NICKNAME
        FROM MEMBER
        WHERE MEMBER_NO = #{memberNo}

    </select>

    <select id="findByEmail" resultType="com.example.todolist.member.dto.MemberDto">
        SELECT MEMBER_NO
             ,MEMBER_EMAIL
             ,MEMBER_PWD
             ,MEMBER_NAME
             ,MEMBER_NICKNAME
          FROM MEMBER
         WHERE MEMBER_EMAIL = #{memberEmail}

    </select>

    <select id="findByNickname" resultType="com.example.todolist.member.dto.MemberDto">
        SELECT MEMBER_NO
             ,MEMBER_EMAIL
             ,MEMBER_NAME
             ,MEMBER_NICKNAME
         FROM MEMBER
        WHERE MEMBER_NICKNAME = #{memberNickname}

    </select>

    <insert id="createMember" parameterType="com.example.todolist.member.dto.MemberRequestDto">
        INSERT INTO MEMBER
                    (
                    MEMBER_EMAIL
                    ,MEMBER_PWD
                    ,MEMBER_NAME
                    ,MEMBER_NICKNAME
                    ,MEMBER_CREATETIME
                    )
             VALUES(
                    #{memberEmail},
                    #{memberPwd},
                    #{memberName},
                    #{memberNickname},
                    NOW()
              )
    </insert>

    <select id="login" resultType="com.example.todolist.member.dto.MemberResponseDto">
        SELECT MEMBER_NO
             ,MEMBER_EMAIL
             ,MEMBER_NAME
             ,MEMBER_NICKNAME
        FROM MEMBER
        WHERE MEMBER_EMAIL = #{memberEmail}
    </select>

    <update id="updateMember">
        UPDATE MEMBER
           SET MEMBER_PWD      = IFNULL(#{memberPwd}, MEMBER_PWD),
               MEMBER_NICKNAME = IFNULL(#{memberNickname}, MEMBER_NICKNAME)
         WHERE MEMBER_NO = #{memberNo}
    </update>

    <select id="findByString" resultType="com.example.todolist.member.dto.MemberResponseDto">
        SELECT MEMBER_NO
             ,MEMBER_NICKNAME
        FROM MEMBER
        WHERE MEMBER_NICKNAME like CONCAT('%', #{search}, '%')

    </select>
</mapper>
